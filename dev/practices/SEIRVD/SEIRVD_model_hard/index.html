<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Problem: SEIRVD Model · StockFlow.jl</title><meta name="title" content="Problem: SEIRVD Model · StockFlow.jl"/><meta property="og:title" content="Problem: SEIRVD Model · StockFlow.jl"/><meta property="twitter:title" content="Problem: SEIRVD Model · StockFlow.jl"/><meta name="description" content="Documentation for StockFlow.jl."/><meta property="og:description" content="Documentation for StockFlow.jl."/><meta property="twitter:description" content="Documentation for StockFlow.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><script src="../../../assets/analytics.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">StockFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">StockFlow.jl</a></li><li><a class="tocitem" href="../../../DSLs/">Domain Specific Languages</a></li><li><a class="tocitem" href="../../../json/">Serialization</a></li><li><span class="tocitem">Example</span><ul><li><a class="tocitem" href="../../../generated/Covid19_composition_model_in_paper/">COVID-19 Composition Model</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/CasualLoopDiagrams/convert_from_SEIR_stockFlowDiagram/">Convert from SEIR Stock Flow Diagram</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/composition/composed_open_population_SIRV_model/">Composed Open Population SIRV Model</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/composition/COVID_full_model/">COVID Full Model</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/composition/curable_sexually_transmitted_diseases_model/">Curable Sexually-Transmitted Diseases Model</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/composition/diabetes_model/">Diabetes Model</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/composition/SEIR_full_model_measles_chickenpox/">SEIR Full Model Measles Chickenpox</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/stratification/diabetes_diagnose/">Diabetes Diagnose</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/stratification/sir_linear_stratification/">SIR Linear Stratification</a></li><li><a class="tocitem" href="../../../generated/full_fledged_schema_examples_new/stratification/sir_standard_stratification/">SIR Standard Stratification</a></li></ul></li><li><span class="tocitem">Exercises</span><ul><li class="is-active"><a class="tocitem" href>Problem: SEIRVD Model</a><ul class="internal"><li><a class="tocitem" href="#Step-1:-Define-Stock-and-Flow-Diagrams-for-the-sub-components"><span>Step 1: Define Stock and Flow Diagrams for the sub-components</span></a></li><li><a class="tocitem" href="#Step-2:-Define-the-UWD-algebra-composition-rule"><span>Step 2: Define the UWD-algebra composition rule</span></a></li><li><a class="tocitem" href="#Step-3:-Solve-the-composed-model"><span>Step 3: Solve the composed model</span></a></li></ul></li><li><a class="tocitem" href="../../SIRV/SIRV_composition_model_simple/">Problem: SIRV Model</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Exercises</a></li><li class="is-active"><a href>Problem: SEIRVD Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Problem: SEIRVD Model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/StockFlow.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/StockFlow.jl/blob/main/docs/src/practices/SEIRVD/SEIRVD_model_hard.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Problem:-SEIRVD-Model"><a class="docs-heading-anchor" href="#Problem:-SEIRVD-Model">Problem: SEIRVD Model</a><a id="Problem:-SEIRVD-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Problem:-SEIRVD-Model" title="Permalink"></a></h1><pre><code class="language-julia hljs">using StockFlow

using Catlab
using Catlab.CategoricalAlgebra
using LabelledArrays
using OrdinaryDiffEq
using Plots

using Catlab.Graphics
using Catlab.Programs
using Catlab.WiringDiagrams</code></pre><p>To build the SEIRVD stock and flow diagram model: <img src="../SEIRVD_composed_model.png" alt="SEIRVD_composed_model.png"/> By composing three sub-components.</p><h2 id="Step-1:-Define-Stock-and-Flow-Diagrams-for-the-sub-components"><a class="docs-heading-anchor" href="#Step-1:-Define-Stock-and-Flow-Diagrams-for-the-sub-components">Step 1: Define Stock and Flow Diagrams for the sub-components</a><a id="Step-1:-Define-Stock-and-Flow-Diagrams-for-the-sub-components-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Define-Stock-and-Flow-Diagrams-for-the-sub-components" title="Permalink"></a></h2><h3 id="1.1-Define-SEIR-model"><a class="docs-heading-anchor" href="#1.1-Define-SEIR-model">1.1 Define SEIR model</a><a id="1.1-Define-SEIR-model-1"></a><a class="docs-heading-anchor-permalink" href="#1.1-Define-SEIR-model" title="Permalink"></a></h3><p><strong>Model 1: SEIR model</strong> <img src="../SEIR_submodel.png" alt="SEIR_submodel.png"/></p><p>The functions of flows are given by:</p><pre><code class="language-julia hljs">finc(u,p,t)=p.cβ*u.S*u.I/p.N
finf(u,p,t)=u.E * p.rlatent
frec(u,p,t)=u.I * p.rrec</code></pre><p>Now, please define the stock and flow diagram of the SEIR model:</p><pre><code class="language-julia hljs"># StockAndFlowp(stocks,
#               (flow=&gt;function, upstream=&gt;downstream) =&gt; stocks linked)</code></pre><p>You can plot the define stock and flow diagram by call function: <code>Graph()</code></p><pre><code class="language-julia hljs">Graph()</code></pre><h3 id="1.2-Define-the-SV-model"><a class="docs-heading-anchor" href="#1.2-Define-the-SV-model">1.2 Define the SV model</a><a id="1.2-Define-the-SV-model-1"></a><a class="docs-heading-anchor-permalink" href="#1.2-Define-the-SV-model" title="Permalink"></a></h3><p><strong>Model 2: SV model</strong> (simulates the vaccination process): <img src="../SV_submodel.png" alt="SV_submodel.png"/></p><p>The function of flow vac is given</p><pre><code class="language-julia hljs">fvac(u,p,t)=u.S * p.rv</code></pre><p>Now, please define the stock and flow diagram and plot it</p><pre><code class="language-julia hljs"># StockAndFlowp(stocks,
#               (flow=&gt;function, upstream=&gt;downstream) =&gt; stocks linked)</code></pre><h3 id="1.3-Define-the-ID-model"><a class="docs-heading-anchor" href="#1.3-Define-the-ID-model">1.3 Define the ID model</a><a id="1.3-Define-the-ID-model-1"></a><a class="docs-heading-anchor-permalink" href="#1.3-Define-the-ID-model" title="Permalink"></a></h3><p><strong>Model 3: ID model</strong> (simulates the deaths due to infected disese) <img src="../ID_submodel.png" alt="ID_submodel.png"/></p><pre><code class="language-julia hljs">fdeath(u,p,t)=u.I * p.rd</code></pre><p>Now, please define the stock and flow diagram and plot it</p><pre><code class="language-julia hljs"># StockAndFlowp(stocks,
#               (flow=&gt;function, upstream=&gt;downstream) =&gt; stocks linked)</code></pre><h2 id="Step-2:-Define-the-UWD-algebra-composition-rule"><a class="docs-heading-anchor" href="#Step-2:-Define-the-UWD-algebra-composition-rule">Step 2: Define the UWD-algebra composition rule</a><a id="Step-2:-Define-the-UWD-algebra-composition-rule-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Define-the-UWD-algebra-composition-rule" title="Permalink"></a></h2><pre><code class="language-julia hljs">uwd_seirvd = @relation (S, I) begin

end;
display_uwd(uwd_seirvd)</code></pre><p>Apply the composition rule to the open stock and flow diagrams</p><pre><code class="language-julia hljs">seirvd=oapply(uwd_seirvd,Dict()) |&gt; apex
Graph(seirvd)</code></pre><h2 id="Step-3:-Solve-the-composed-model"><a class="docs-heading-anchor" href="#Step-3:-Solve-the-composed-model">Step 3: Solve the composed model</a><a id="Step-3:-Solve-the-composed-model-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Solve-the-composed-model" title="Permalink"></a></h2><p>Define the constant parameters values, and stocks initial values. The values are given. Please note those values are arbitrary given for toy model running. You can try to modify those values based on your interested infectious diseases.</p><pre><code class="language-julia hljs">p = LVector(
    cβ=0.2, N=1000, rrec=0.083, rv=0.02, rlatent=0.2, rd=0.0001
)
# Define initial values for stocks
u0 = LVector(
    S=990, E=0, I=10, R=0, V=0, D=0
)</code></pre><p>Solve the ODEs generated from the composed stock and flow diagram</p><pre><code class="language-julia hljs">prob = ODEProblem(vectorfield(seirvd),u0,(0.0,100.0),p);
sol = solve(prob,Tsit5(),abstol=1e-8);
plot(sol)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../generated/full_fledged_schema_examples_new/stratification/sir_standard_stratification/">« SIR Standard Stratification</a><a class="docs-footer-nextpage" href="../../SIRV/SIRV_composition_model_simple/">Problem: SIRV Model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Wednesday 14 February 2024 21:33">Wednesday 14 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
